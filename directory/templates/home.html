{% extends "base.html" %}
{% load static %}

{% block title %}ouray.info — directory{% endblock %}
{% block body_class %}home{% endblock %}

{% block extra_head %}
  <link rel="preload" as="image" href="{% static 'directory/img/abrams-image.jpg' %}">
  <link rel="preload" as="image" href="{% static 'directory/img/ouray-hero.jpg' %}">
  <link rel="preload" as="image" href="{% static 'directory/img/ouray-winter.jpg' %}">
{% endblock %}

{% block content %}

<nav class="topnav" aria-label="Categories">
  <div class="container topnav-inner">
    <a class="topnav-link" href="#coffee">Explore</a>
    <a class="topnav-link" href="/contact/">Contact</a>
    <a class="topnav-link" href="/bookmarks/">Bookmarked</a>
  </div>
</nav>

<section class="band band--hero" style="--band-image: url('{% static "directory/img/abrams-image.jpg" %}');">
  <div class="band-overlay"></div>
  <div class="container hero-inner">
    <h1 class="home-title">ouray.info</h1>
    <p class="home-subtitle">Local businesses in Ouray, Colorado.</p>

    <form class="sort-form" method="get">
      <label class="sort-label" for="sort">Sort:</label>
      <select id="sort" name="sort" class="sort-select" onchange="this.form.submit()">
        <option value="top" {% if sort == "top" %}selected{% endif %}>Top Rated (ouray.info)</option>
        <option value="google" {% if sort == "google" %}selected{% endif %}>Top Rated (Google)</option>
        <option value="az" {% if sort == "az" %}selected{% endif %}>A–Z</option>
      </select>
    </form>
  </div>
</section>

<section id="coffee" class="band band--solid band--coffee">
  <div class="container band-head">
    <h2 class="band-title">Coffee</h2>
    <p class="band-meta">Cafés, espresso, bakeries, and quick stops.</p>
  </div>

  <div class="container" data-fade="true">
    <div class="card-row" aria-label="Coffee businesses">
      {% for b in businesses %}
        {% if b.category and b.category|lower == "coffee" %}
          <article class="card">
            <div class="card-top">
              <h3 class="card-title"><a href="{% url 'business_detail' b.slug %}">{{ b.name }}</a></h3>
              <span class="pill">{{ b.category }}</span>
            </div>
            <div class="card-rating">
              {% if b.review_count %}
                <span class="rating-count">{{ b.review_count }} reviews</span>
                <span class="star-bar" style="--fill-percent: {{ b.ouray_fill_percent }}%;"></span>
              {% else %}
                <span class="rating-count">No ouray.info reviews yet</span>
              {% endif %}
            </div>
            {% if b.google_rating %}
              <div class="card-google">Google &#9733; {{ b.google_rating|floatformat:1 }} ({{ b.google_user_count }})</div>
            {% endif %}
            {% if b.description %}
              <p class="card-desc">{{ b.description|truncatechars:140 }}</p>
            {% else %}
              <p class="card-desc card-desc--muted">No description yet.</p>
            {% endif %}
            <div class="card-actions">
              <a class="btn btn-ghost" href="{% url 'business_detail' b.slug %}">Details</a>
              {% if b.website %}<a class="btn" href="{{ b.website }}" target="_blank" rel="noopener">Website</a>{% endif %}
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<section id="restaurants" class="band band--image" style="--band-image: url('{% static "directory/img/ouray-hero.jpg" %}');">
  <div class="band-overlay"></div>

  <div class="container band-head band-head--light">
    <h2 class="band-title">Restaurants</h2>
    <p class="band-meta">Sit-down, casual, takeout, and everything in between.</p>
  </div>

  <div class="container" data-fade="true">
    <div class="card-row" aria-label="Restaurant businesses">
      {% for b in businesses %}
        {% if b.category and b.category|lower == "restaurants" %}
          <article class="card">
            <div class="card-top">
              <h3 class="card-title"><a href="{% url 'business_detail' b.slug %}">{{ b.name }}</a></h3>
              <span class="pill">{{ b.category }}</span>
            </div>
            <div class="card-rating">
              {% if b.review_count %}
                <span class="rating-count">{{ b.review_count }} reviews</span>
                <span class="star-bar" style="--fill-percent: {{ b.ouray_fill_percent }}%;"></span>
              {% else %}
                <span class="rating-count">No ouray.info reviews yet</span>
              {% endif %}
            </div>
            {% if b.google_rating %}
              <div class="card-google">Google &#9733; {{ b.google_rating|floatformat:1 }} ({{ b.google_user_count }})</div>
            {% endif %}
            {% if b.description %}
              <p class="card-desc">{{ b.description|truncatechars:140 }}</p>
            {% else %}
              <p class="card-desc card-desc--muted">No description yet.</p>
            {% endif %}
            <div class="card-actions">
              <a class="btn btn-ghost" href="{% url 'business_detail' b.slug %}">Details</a>
              {% if b.website %}<a class="btn" href="{{ b.website }}" target="_blank" rel="noopener">Website</a>{% endif %}
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<section id="shopping" class="band band--solid band--shopping">
  <div class="container band-head">
    <h2 class="band-title">Shopping</h2>
    <p class="band-meta">Gifts, gear, local goods, and essentials.</p>
  </div>

  <div class="container" data-fade="true">
    <div class="card-row" aria-label="Shopping businesses">
      {% for b in businesses %}
        {% if b.category and b.category|lower == "shopping" %}
          <article class="card">
            <div class="card-top">
              <h3 class="card-title"><a href="{% url 'business_detail' b.slug %}">{{ b.name }}</a></h3>
              <span class="pill">{{ b.category }}</span>
            </div>
            <div class="card-rating">
              {% if b.review_count %}
                <span class="rating-count">{{ b.review_count }} reviews</span>
                <span class="star-bar" style="--fill-percent: {{ b.ouray_fill_percent }}%;"></span>
              {% else %}
                <span class="rating-count">No ouray.info reviews yet</span>
              {% endif %}
            </div>
            {% if b.google_rating %}
              <div class="card-google">Google &#9733; {{ b.google_rating|floatformat:1 }} ({{ b.google_user_count }})</div>
            {% endif %}
            {% if b.description %}
              <p class="card-desc">{{ b.description|truncatechars:140 }}</p>
            {% else %}
              <p class="card-desc card-desc--muted">No description yet.</p>
            {% endif %}
            <div class="card-actions">
              <a class="btn btn-ghost" href="{% url 'business_detail' b.slug %}">Details</a>
              {% if b.website %}<a class="btn" href="{{ b.website }}" target="_blank" rel="noopener">Website</a>{% endif %}
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<!-- Snowy image band: Attractions -->
<section id="attractions" class="band band--image band--snow" style="--band-image: url('{% static "directory/img/ouray-winter.jpg" %}');">
  <div class="band-overlay band-overlay--snow"></div>

  <div class="container band-head band-head--snow band-head--attractions">
    <h2 class="band-title">Attractions</h2>
    <p class="band-meta">Trails, sights, experiences, and local gems.</p>
  </div>

  <div class="container" data-fade="true">
    <div class="card-row" aria-label="Attractions businesses">
      {% for b in businesses %}
        {% if b.category and b.category|lower == "attractions" %}
          <article class="card">
            <div class="card-top">
              <h3 class="card-title"><a href="{% url 'business_detail' b.slug %}">{{ b.name }}</a></h3>
              <span class="pill">{{ b.category }}</span>
            </div>
            <div class="card-rating">
              {% if b.review_count %}
                <span class="rating-count">{{ b.review_count }} reviews</span>
                <span class="star-bar" style="--fill-percent: {{ b.ouray_fill_percent }}%;"></span>
              {% else %}
                <span class="rating-count">No ouray.info reviews yet</span>
              {% endif %}
            </div>
            {% if b.google_rating %}
              <div class="card-google">Google &#9733; {{ b.google_rating|floatformat:1 }} ({{ b.google_user_count }})</div>
            {% endif %}
            {% if b.description %}
              <p class="card-desc">{{ b.description|truncatechars:140 }}</p>
            {% else %}
              <p class="card-desc card-desc--muted">No description yet.</p>
            {% endif %}
            <div class="card-actions">
              <a class="btn btn-ghost" href="{% url 'business_detail' b.slug %}">Details</a>
              {% if b.website %}<a class="btn" href="{{ b.website }}" target="_blank" rel="noopener">Website</a>{% endif %}
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<section id="other" class="band band--solid band--other">
  <div class="container band-head">
    <h2 class="band-title">Other</h2>
    <p class="band-meta">Everything not yet categorized.</p>
  </div>

  <div class="container" data-fade="true">
    <div class="card-row" aria-label="Other businesses">
      {% for b in businesses %}
        {% if not b.category or b.category|lower not in "coffee restaurants shopping attractions" %}
          <article class="card">
            <div class="card-top">
              <h3 class="card-title"><a href="{% url 'business_detail' b.slug %}">{{ b.name }}</a></h3>
              {% if b.category %}<span class="pill">{{ b.category }}</span>{% endif %}
            </div>
            <div class="card-rating">
              {% if b.review_count %}
                <span class="rating-count">{{ b.review_count }} reviews</span>
                <span class="star-bar" style="--fill-percent: {{ b.ouray_fill_percent }}%;"></span>
              {% else %}
                <span class="rating-count">No ouray.info reviews yet</span>
              {% endif %}
            </div>
            {% if b.google_rating %}
              <div class="card-google">Google &#9733; {{ b.google_rating|floatformat:1 }} ({{ b.google_user_count }})</div>
            {% endif %}
            {% if b.description %}
              <p class="card-desc">{{ b.description|truncatechars:140 }}</p>
            {% else %}
              <p class="card-desc card-desc--muted">No description yet.</p>
            {% endif %}
            <div class="card-actions">
              <a class="btn btn-ghost" href="{% url 'business_detail' b.slug %}">Details</a>
              {% if b.website %}<a class="btn" href="{{ b.website }}" target="_blank" rel="noopener">Website</a>{% endif %}
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

{% endblock %}






